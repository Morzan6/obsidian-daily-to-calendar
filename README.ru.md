# Obsidian Daily to Calendar (RU)

Плагин, который автоматически синхронизирует расписание из ваших ежедневных заметок Obsidian с Google Календарём, поддерживая актуальность планов и событий.

## Возможности

- **Синхронизация расписания на сегодня**: Быстро синхронизируйте расписание из сегодняшней ежедневной заметки в Google Календарь
- **Массовая синхронизация**: Синхронизируйте все ежедневные заметки сразу, чтобы заполнить календарь
- **Автосинхронизация при изменении**: Автоматическая синхронизация при изменении ежедневных заметок (опционально)
- **Умный разбор**: Понимает различные форматы времени и записи расписания из ежедневных заметок
- **Предотвращение дублей**: Избегает создания дубликатов событий благодаря отслеживанию уже синхронизированного контента
- **Настраиваемость**: Настройка ID календаря, заголовка раздела расписания, часового пояса и др.

## Установка

1. Скачайте последнюю версию на странице релизов
2. Распакуйте файлы в папку плагинов Obsidian: `.obsidian/plugins/obsidian-daily-to-calendar/`
3. Включите плагин в настройках Obsidian
4. Настройте учетные данные API Google Календаря (см. раздел «Настройка»)

## Настройка

### Настройка Google Calendar API

Плагин использует Google Calendar API для создания и управления событиями. Вам необходимо создать проект в Google Cloud и сервисную учетную запись для аутентификации с Google Календарём.

1. **Создайте проект в Google Cloud**
   - Перейдите в [Google Cloud Console](https://console.cloud.google.com/)
   - Нажмите «Выбрать проект» → «Создать проект»
   - Дайте проекту имя (например, «Obsidian Calendar Sync»)
   - Нажмите «Создать»

2. **Включите Google Calendar API**
   - В консоли проекта откройте «APIs & Services» → «Library»
   - Найдите «Google Calendar API»
   - Откройте и нажмите «Enable»

3. **Создайте сервисную учетную запись**
   - Перейдите в «APIs & Services» → «Credentials»
   - Нажмите «Create Credentials» → «Service Account»
   - Укажите имя (например, `obsidian-calendar-sync`)
   - Нажмите «Create and Continue»
   - Пропустите необязательные шаги и нажмите «Done»

4. **Сгенерируйте и скачайте ключ**
   - Откройте созданную сервисную учетную запись
   - Перейдите на вкладку «Keys»
   - Нажмите «Add Key» → «Create New Key»
   - Выберите формат «JSON» и нажмите «Create»
   - Надёжно сохраните скачанный JSON-файл (он содержит закрытый ключ)

5. **Поделитесь календарём с сервисной учетной записью**
   - Откройте Google Календарь в браузере
   - Найдите календарь для синхронизации (или создайте новый)
   - Нажмите на три точки рядом с названием календаря → «Настройки и доступ»
   - В разделе «Открыть доступ для отдельных пользователей» нажмите «Добавить пользователей»
   - Введите адрес сервисной учетной записи (смотрите поле `client_email` в JSON)
   - Установите права «Вносить изменения в события»
   - Нажмите «Отправить»

6. **Получите ID календаря**
   - На той же странице настроек пролистайте до «ID календаря»
   - Скопируйте этот ID (обычно вида `your-email@gmail.com` или длинная строка, оканчивающаяся на `@group.calendar.google.com`)
   - Он потребуется для конфигурации плагина

7. **Настройте плагин**
   - Откройте скачанный JSON-файл в текстовом редакторе
   - Скопируйте его содержимое целиком
   - В Obsidian откройте настройки плагина и вставьте содержимое в поле «Ключ сервисной учетной записи» (Service Account Key)

### Конфигурация плагина

Откройте настройки плагина и укажите:

- **Service Account Key**: Вставьте JSON-ключ вашей сервисной учетной записи Google
- **Calendar ID**: ID Google Календаря для синхронизации
- **Schedule Heading**: Заголовок раздела в ежедневных заметках, где находится расписание (по умолчанию: «Schedule»)
- **Daily Notes Folder**: Путь к папке с ежедневными заметками
- **Time Zone**: Ваш часовой пояс для корректного времени событий
- **Default Event Duration**: Длительность для событий без времени окончания
- **Auto-sync on Modify**: Включить автосинхронизацию при изменениях ежедневных заметок

## Использование

### Формат расписания

В ежедневной заметке создайте раздел расписания, например:

```markdown
## Schedule

- 09:00-10:30 Встреча команды
- 11:00 Приём у врача
- 14:00-15:00 Обзор проекта
- 16:30 Звонок с клиентом
- All day: Конференция
```

Поддерживаемые форматы времени:
- `HH:MM-HH:MM` (интервал времени)
- `HH:MM` (точка времени, используется длительность по умолчанию)
- `All day:` (событие на весь день)

### Синхронизация

**Ручная синхронизация:**
- Нажмите значок календаря на ленте, чтобы синхронизировать расписание на сегодня
- Используйте значок «Sync ALL» на ленте для синхронизации всех ежедневных заметок
- Воспользуйтесь командной палитрой: «Sync Today's Schedule to Google Calendar»

**Автосинхронизация:**
- Включите «Auto-sync on Modify» в настройках
- Плагин будет автоматически синхронизироваться при изменении ежедневных заметок

### Индикатор статуса

Строка статуса отображает текущее состояние синхронизации:
- **Idle**: Готов к синхронизации
- **Syncing**: Выполняется синхронизация
- **Error**: Последняя синхронизация завершилась с ошибкой

## Команды

- **Sync Today's Schedule to Google Calendar**: Синхронизирует сегодняшнюю ежедневную заметку
- **Sync ALL Daily Notes to Google Calendar**: Синхронизирует все ежедневные заметки в папке

## Устранение неполадок

### Частые проблемы

1. **Ошибки аутентификации**
   - Проверьте корректность JSON-ключа сервисной учетной записи
   - Убедитесь, что календарь расшарен для email вашей сервисной учетной записи
   - Убедитесь, что Google Calendar API включён в консоли Google Cloud

2. **События не создаются**
   - Проверьте, что заголовок расписания совпадает с вашими заметками
   - Убедитесь, что используемый формат времени поддерживается
   - Проверьте правильность пути к папке ежедневных заметок

3. **Дубликаты событий**
   - Плагин отслеживает синхронизированный контент, чтобы избегать дублей
   - Если дубли появились, попробуйте очистить данные плагина и повторно синхронизировать

### Отладочная информация

Откройте консоль разработчика (Ctrl+Shift+I), чтобы просмотреть подробные сообщения об ошибках и логи синхронизации.

## Разработка

### Сборка плагина

```bash
npm install
npm run build
```

### Режим разработки

```bash
npm run dev
```

## Вклад

Будем рады вашим предложениям! Присылайте issues и pull requests.

## Лицензия

Лицензия MIT — см. файл LICENSE для подробностей.

## Поддержка

Если этот плагин полезен вам, поддержите его развитие:
- Сообщайте об ошибках и отправляйте запросы фич в Issues на GitHub
- Вносите улучшения в код
- Поделитесь плагином с пользователями Obsidian

---

**Автор**: Morzan6 (n.kusmaul@yandex.ru)  
**Версия**: 1.1.1
